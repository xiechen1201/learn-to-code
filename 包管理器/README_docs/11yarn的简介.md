# 11 yarn 的简介

yarn 是基于 npm 的，对 npm 进行了一些改进和优化。

yarn 使用的仍然是 npm 的 registry，不过提供了新的 CLI 命令。

npm 之前存在的问题：

1、依赖目录嵌套的太深，windows 无法支持太深的目录

```md
A
    node_modules
        B
            node_modules
                c
                    node_modules
                        ...
```

2、下载速度缓慢

    因为依赖是嵌套层次的，所以 npm 对包的下载只能是串行的，前一个包下载完成才能继续下载下一个包

    多个相同的版本被重复下载

3、控制台输出繁杂

4、工程移植问题

依赖版本模糊，拷贝后安装依赖的版本可能发生变化，无法完全还原开发时的环境

## yarn 的优点

1、扁平化依赖

2、并行下载

3、使用本地缓存（下次安装的时候，版本一样的时候直接从缓存拷贝）

4、控制台只显示关键的信息

5、使用 yarn-lock 文件确切记录

还优化了下面的内容：

1、增加了更加好强大的命令

2、让既有的命令更加语义话

3、本地安装的 CLI 可以直接使用 yarn 进行启动

4、对全局安装目录当作一个普通的工程，生成 packgae.json 文件，便于全局安装移植

## npm 的优化

yarn 对 npm 产生巨大的压力，到 npm6 几乎解决了上面的问题：

1、目录扁平化

2、并行下载

3、本地缓存

```bash
# 清除缓存
$ npm cache clean
```

4、使用 package-lock 文件锁版本

5、新增大量的命令别名

6、内置了 npx，可以启动本地的 cli 工具

7、简化了控制台的输出

## 安装 

详见：https://yarn.bootcss.com/docs/install.html#mac-stable

